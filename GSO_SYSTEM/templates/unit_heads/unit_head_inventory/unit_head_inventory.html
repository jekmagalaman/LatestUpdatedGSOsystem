{% extends "unit_heads/unit_head_base_dashboard.html" %}

{% block title %}Inventory{% endblock %}

{% block main_content %}
<!-- ======= HEADER ======= -->
{% if not unit %}
<div class="alert alert-warning text-center mt-4">
  <strong>Notice:</strong> You are not assigned to any unit. Please contact the GSO Office for assistance.
</div>
{% else %}
<div class="header d-flex align-items-center justify-content-between mb-3">
  <h1 class="page-title mb-0">
    INVENTORY – {{ unit.name|upper }}
  </h1>

  <form method="get" class="d-flex gap-2 align-items-center">
    <!-- Search -->
    <input 
      type="text" 
      name="q" 
      class="form-control form-control-sm" 
      placeholder="Search materials..." 
      value="{{ search_query|default:'' }}"
      autocomplete="off"
    >

    <!-- Category Filter -->
    <select 
      name="category" 
      class="form-select form-select-sm" 
      onchange="this.form.submit()"
    >
      <option value="">All Categories</option>
      {% for c in categories %}
        <option value="{{ c }}" {% if selected_category == c %}selected{% endif %}>
          {{ c }}
        </option>
      {% endfor %}
    </select>

    <button type="submit" class="btn btn-primary btn-sm">Search</button>
  </form>
</div>

<!-- ======= INVENTORY TABLE ======= -->
<div class="table-container table-responsive">
  <table class="table table-hover align-middle">
    <thead class="table-light">
      <tr>
        <th>NO.</th>
        <th>MATERIAL NAME</th>
        <th>DESCRIPTION</th>
        <th>CATEGORY</th>
        <th>QUANTITY</th>
      </tr>
    </thead>
    <tbody>
      {% for material in inventory_items %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td>{{ material.name }}</td>
        <td>{{ material.description|default:"—" }}</td>
        <td>{{ material.category|default:"—" }}</td>
        <td>{{ material.quantity }} {{ material.unit_of_measurement }}</td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="7" class="text-center text-muted py-3">
          No materials found under your unit.
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endif %}
{% endblock %}
